import{o as e,c as t,a as n,b as a,d as r,t as s,r as o,e as i,f as l,n as c,u as d,g as u,h as m,i as p,w as g,j as f,k as h}from"./vendor.d5e787fa.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var y=(e,t)=>{for(const[n,a]of t)e[n]=a;return e};const v={},E=[n("img",{class:"animate-bounce mx-auto select-none",alt:"logo",src:"/fruition-with-comments/assets/logo.82833b22.png"},null,-1),n("h1",{class:"font-black pt-6 text-4xl tracking-wider"}," fruition-with-comments ",-1),n("h3",{class:"pt-2"},[a(" Add a comments system using "),n("b",null,"Giscus"),a(" to a site built with "),n("b",null,"Fruition")],-1)];var b=y(v,[["render",function(n,a){return e(),t("header",null,E)}]]);const w={class:"material-icons-outlined text-xl"},x=r({props:{isError:{type:Boolean,required:!1}},setup(a){const r=a,{isError:u}=s(o(r)),m=i(!1),p=i(!1),g=(()=>{let e;return()=>{(null==u?void 0:u.value)||(m.value=!0,p.value=!0,e&&clearInterval(e),e=setTimeout((()=>{p.value=!1,e=null}),1e3))}})();return(a,r)=>(e(),t("div",{class:c(["bg-white border-1 border-gray-300 border-solid cursor-pointer duration-150 flex h-9 items-center justify-center rounded-md text-gray-400 w-9 hover:bg-gray-100 hover:text-gray-500",{"hover:bg-gray-200":m.value,"hover:cursor-not-allowed":d(u)}]),onMousedown:r[0]||(r[0]=(...e)=>d(g)&&d(g)(...e)),onMouseup:r[1]||(r[1]=e=>m.value=!1)},[n("span",w,l(p.value?"done":"content_copy"),1)],34))}}),T=o({repo:"","repo-id":"",category:"","category-id":"","reactions-enabled":"","emit-metadata":"",theme:""}),R={class:"duration-150 max-w-screen-lg relative transform w-full hover:-translate-y-2px"},L=["placeholder","value","isReadonly","readonly"],C=r({props:{placeholder:{type:String,required:!1},isReadonly:{type:Boolean,required:!1},modelValue:{type:String,required:!1},isError:{type:Boolean,required:!1},userDatas:{type:null,required:!1}},emits:["update:modelValue"],setup(a,{emit:r}){const i=a,{isReadonly:l,isError:g,userDatas:f}=s(o(i)),h=u((()=>{if(!(null==f?void 0:f.value)||(null==g?void 0:g.value))return"Generated Cloudflare Worker Script";return(e=>[`<script type="module">\nconst commentsConfigs = {\n  target: 'giscus',\n  repo: '${e.repo}',\n  mapping: 'url',\n\n  repoId: '${e["repo-id"]}',\n  category: '${e.category}',\n  categoryId: '${e["category-id"]}',\n  term: '',\n  reactions: ${"1"===e["reactions-enabled"]?"true":"false"},\n  metadata: ${"1"===e["emit-metadata"]?"true":"false"},\n  theme: '${e.theme}',\n};\n\nconst genScriptElement = () => {\n  const el = document.createElement('script');\n\n  const {\n    repoId,\n    category,\n    categoryId,\n    term,\n    reactions,\n    metadata,\n    theme,\n  } = commentsConfigs;\n\n  const configs = {\n    src: 'https://giscus.app/client.js',\n    crossorigin: 'anonymous',\n    async: true,\n    'data-repo': commentsConfigs.repo,\n    'data-repo-id': repoId,\n    'data-category': category,\n    'data-category-id': categoryId,\n    'data-term': term,\n    'data-mapping': commentsConfigs.mapping,\n    'data-reactions-enabled': (reactions ? 1 : 0),\n    'data-emit-metadata': (metadata ? 1 : 0),\n    'data-theme': theme,\n  };\n\n  for (const [key, value] of Object.entries(configs)) {\n    el.setAttribute(key, value);\n  }\n\n  return el;\n};\n\nconst appendGiscusElement = mutations => {\n  const appendTargetLastChildren = mutations\n    .filter(({ target }) => target.classList.contains('notion-scroller'))\n    .flatMap(({ addedNodes }) => [...addedNodes])\n    .filter(node => node.classList.contains('notion-presence-container'));\n\n  if (appendTargetLastChildren.length === 0) {\n    return;\n  }\n\n  const [appendTargetLastChild] = appendTargetLastChildren;\n  const appendTarget = appendTargetLastChild.parentElement;\n\n  if (appendTarget.dataset.comments) {\n    return;\n  }\n\n  appendTarget.dataset.comments = true;\n  appendTarget.insertBefore(genScriptElement(), appendTargetLastChild);\n};\n\nconst fixGiscusIFrameURL = mutations => {\n  const giscusElements = mutations\n    .filter(({ target }) => target.classList.contains('notion-scroller'))\n    .flatMap(({ addedNodes }) => [...addedNodes])\n    .filter(node => node.classList.contains('giscus'));\n\n  if (giscusElements.length === 0) {\n    return;\n  }\n\n  const [giscusElement] = giscusElements;\n  const giscusIFrameElement = giscusElement.firstChild;\n  const matchedTerm = giscusIFrameElement?.getAttribute('src').match(/term=(.*)/);\n\n  if (!matchedTerm || !matchedTerm[1]) {\n    return;\n  }\n\n  const termURL = decodeURIComponent(matchedTerm[1]);\n  const newTermURL = termURL.replace(/\\?giscus=.*/, '');\n  const newSrc = giscusIFrameElement\n    .getAttribute('src')\n    .replace(/term=.*/, 'term=' + encodeURIComponent(newTermURL));\n\n  giscusIFrameElement.setAttribute('src', newSrc);\n  window.history.replaceState(window.history.state, 'bypass', window.location.pathname);\n};\n\nnew MutationObserver(mutations => {\n  appendGiscusElement(mutations);\n  fixGiscusIFrameURL(mutations);\n}).observe(document.querySelector('div#notion-app'), {\n  subtree: true,\n  childList: true,\n});\n  <\/script>`,"<style>\n  .notion-page-content {\n    padding-bottom: 5vh !important;\n  }\n  .giscus {\n    width: 900px;\n    max-width: 100%;\n    padding-left: calc(96px + env(safe-area-inset-left));\n    padding-right: calc(96px + env(safe-area-inset-right));\n    padding-bottom: 5vh;\n  }\n  </style>"].join("\n"))(f.value)})),y=()=>{(null==g?void 0:g.value)||navigator.clipboard.writeText(h.value)},v=({currentTarget:e})=>r("update:modelValue",e.value),E=({currentTarget:e})=>{(null==l?void 0:l.value)||e.select()};return(r,s)=>(e(),t("div",R,[n("textarea",{class:c(["border border-gray-200 duration-150 h-240px max-w-screen-lg outline-none p-4 resize-none rounded-md shadow-md text-xs w-full hover:shadow-lg",{"cursor-default":d(l),"cursor-not-allowed":d(g),"text-gray-500":d(l)}]),placeholder:a.placeholder,value:d(l)?d(h):a.modelValue,isReadonly:d(l),readonly:d(l),onInput:v,onClick:E},null,42,L),d(l)?(e(),m(x,{key:0,class:"absolute right-4 top-4",onClick:y,isError:d(g)},null,8,["isError"])):p("",!0)]))}}),I={class:"antialiased break-words flex flex-col gap-12 justify-center pt-20 px-4 pb-12 select-none text-center"},k={class:"flex flex-col gap-8 items-center px-12"},j=n("section",{class:"flex font-bold gap-2 justify-center text-blue-500"},[n("a",{class:"hover:underline",href:"https://github.com/Gumball12/fruition-with-giscus",target:"_blank"},"GitHub"),n("a",{class:"hover:underline",href:"https://fruition-with-giscus.shj.rip",target:"_blank"},"Notion")],-1);h(r({setup(a){const r=i(""),s=i(!1);return g(r,(e=>{const t=document.createElement("template");t.innerHTML=e;const n=t.content.firstElementChild;(({userDatas:e,scriptElem:t})=>!!t&&![["src","https://giscus.app/client.js",!1],...Object.keys(e).map((e=>[`data-${e}`,"",!0])),["data-mapping","url",!1],["crossorigin","anonymous",!1]].some((([e,n,a])=>!t.hasAttribute(e)||t.getAttribute(e)===n===a)))({userDatas:T,scriptElem:n})?((({scriptElem:e,userDatas:t})=>{Object.keys(t).forEach((n=>{var a;return t[n]=null!=(a=e.getAttribute(`data-${n}`))?a:""}))})({scriptElem:n,userDatas:T}),s.value=!0):s.value=!1})),(a,o)=>(e(),t("main",I,[f(b),n("section",k,[f(C,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=e=>r.value=e),placeholder:'<script\n    src="https://giscus.app/client.js"\n    data-repo="[ENTER REPO HERE]"\n    data-repo-id="[ENTER REPO ID HERE]"\n    data-category="[ENTER CATEGORY NAME HERE]"\n    data-category-id="[ENTER CATEGORY ID HERE]"\n    data-mapping="url"\n    data-reactions-enabled="1"\n    data-emit-metadata="0"\n    data-theme="light"\n    crossorigin="anonymous"\n    async>\n<\/script>'},null,8,["modelValue"]),f(C,{userDatas:d(T),isReadonly:!0,isError:!s.value},null,8,["userDatas","isError"])]),j]))}})).mount("#app");
